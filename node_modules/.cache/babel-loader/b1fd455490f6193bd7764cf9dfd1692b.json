{"ast":null,"code":"var _s = $RefreshSig$();\n//facial-rec.js\nimport { useEffect, useState, useRef } from 'react';\nimport * as faceLandmarksDetection from '@tensorflow-models/face-landmarks-detection';\nimport '@tensorflow/tfjs-backend-webgl';\nexport const useFaceDetector = videoRef => {\n  _s();\n  const [detector, setDetector] = useState(null);\n  const detectionInterval = useRef(null);\n  const audioRef = useRef(new Audio('/ringtone-126505.mp3'));\n  const [playSound, setPlaySound] = useState(false);\n  useEffect(() => {\n    const loadModel = async () => {\n      const model = faceLandmarksDetection.SupportedModels.MediaPipeFaceMesh;\n      const detectorConfig = {\n        runtime: 'tfjs',\n        // or 'tfjs'\n        solutionPath: 'https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh'\n      };\n      const detector = await faceLandmarksDetection.createDetector(model, detectorConfig);\n      setDetector(detector);\n    };\n    loadModel();\n  }, []);\n  useEffect(() => {\n    if (detector && videoRef.current) {\n      detectionInterval.current = setInterval(async () => {\n        if (videoRef.current && !videoRef.current.paused && !videoRef.current.ended) {\n          const faces = await detector.estimateFaces(videoRef.current, {\n            flipHorizontal: false\n          });\n          //console.log(faces[0].filter(items => Object.keys('keypoints').hasOwnProperty('name')));\n\n          try {\n            const faceNames = faces[0]['keypoints'].filter(items => items.hasOwnProperty('name'));\n            //console.log(faces[0]['keypoints'].filter(items => items.hasOwnProperty('name')));\n            const rightEye = faceNames.filter(items => items[\"name\"] == \"rightEye\")[2].x;\n            const leftEye = faceNames.filter(items => items[\"name\"] == \"leftEye\")[2].x;\n            const faceOvalRight = faceNames.filter(items => items[\"name\"] == \"faceOval\")[26].x;\n            const faceOvalLeft = faceNames.filter(items => items[\"name\"] == \"faceOval\")[15].x;\n            if (rightEye && leftEye && faceOvalRight && faceOvalLeft) {\n              if (rightEye + 50 > faceOvalRight || leftEye - 50 < faceOvalLeft) {\n                if (!playSound) {\n                  setPlaySound(true);\n                  audioRef.current.play();\n                }\n              } else {\n                if (playSound) {\n                  setPlaySound(false);\n                  audioRef.current.pause();\n                  audioRef.current.currentTime = 0;\n                }\n              }\n            }\n          } catch (error) {\n            console.log(false);\n            audioRef.current.play();\n            audioRef.current.currentTime = 0;\n          }\n          // if (rightEye + 50 > faceOvalRight || leftEye - 50 < faceOvalLeft) {\n          //     console.log(false);\n          // } else {\n          //     console.log(true);\n          // }\n\n          //console.log(rightEye);\n          // Additional logic to handle the detected faces\n        }\n      }, 3000); // Run detection every 1000 milliseconds (1 second)\n    }\n    return () => {\n      if (detectionInterval.current) {\n        clearInterval(detectionInterval.current);\n      }\n      audioRef.current.pause();\n    };\n  }, [detector, videoRef]);\n  return null;\n};\n_s(useFaceDetector, \"TvLLSFIwkrzV/noFkLAUu1ZEITM=\");","map":{"version":3,"names":["useEffect","useState","useRef","faceLandmarksDetection","useFaceDetector","videoRef","_s","detector","setDetector","detectionInterval","audioRef","Audio","playSound","setPlaySound","loadModel","model","SupportedModels","MediaPipeFaceMesh","detectorConfig","runtime","solutionPath","createDetector","current","setInterval","paused","ended","faces","estimateFaces","flipHorizontal","faceNames","filter","items","hasOwnProperty","rightEye","x","leftEye","faceOvalRight","faceOvalLeft","play","pause","currentTime","error","console","log","clearInterval"],"sources":["/Users/sanskarmishra/Hackathon-2024/sera/src/facial-rec.js"],"sourcesContent":["//facial-rec.js\nimport { useEffect, useState, useRef } from 'react';\nimport * as faceLandmarksDetection from '@tensorflow-models/face-landmarks-detection';\nimport '@tensorflow/tfjs-backend-webgl';\n\nexport const useFaceDetector = (videoRef) => {\n    const [detector, setDetector] = useState(null);\n    const detectionInterval = useRef(null);\n    const audioRef = useRef(new Audio('/ringtone-126505.mp3'));\n    const [playSound, setPlaySound] = useState(false);\n\n    useEffect(() => {\n        const loadModel = async () => {\n            const model = faceLandmarksDetection.SupportedModels.MediaPipeFaceMesh;\n            const detectorConfig = {\n                runtime: 'tfjs', // or 'tfjs'\n                solutionPath: 'https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh',\n            };\n            const detector = await faceLandmarksDetection.createDetector(model, detectorConfig);\n            setDetector(detector);\n        };\n\n        loadModel();\n    }, []);\n\n    useEffect(() => {\n        if (detector && videoRef.current) {\n            detectionInterval.current = setInterval(async () => {\n                if (videoRef.current && !videoRef.current.paused && !videoRef.current.ended) {\n                    const faces = await detector.estimateFaces(videoRef.current, { flipHorizontal: false });\n                    //console.log(faces[0].filter(items => Object.keys('keypoints').hasOwnProperty('name')));\n                    \n                    try{\n                        const faceNames = faces[0]['keypoints'].filter(items => items.hasOwnProperty('name'));\n                        //console.log(faces[0]['keypoints'].filter(items => items.hasOwnProperty('name')));\n                        const rightEye = faceNames.filter(items => items[\"name\"] == \"rightEye\")[2].x;\n                        const leftEye = faceNames.filter(items => items[\"name\"] == \"leftEye\")[2].x;\n                        const faceOvalRight = faceNames.filter(items => items[\"name\"] == \"faceOval\")[26].x;\n                        const faceOvalLeft = faceNames.filter(items => items[\"name\"] == \"faceOval\")[15].x;\n                        if (rightEye && leftEye && faceOvalRight && faceOvalLeft) {\n                            if (rightEye + 50 > faceOvalRight || leftEye - 50 < faceOvalLeft) {\n                                if (!playSound) {\n                                    setPlaySound(true);\n                                    audioRef.current.play();\n                                }\n                            } else {\n                                if (playSound) {\n                                    setPlaySound(false);\n                                    audioRef.current.pause();\n                                    audioRef.current.currentTime = 0;\n                                }\n                            }\n                        }\n                    } catch (error){\n                        console.log(false);\n                        audioRef.current.play();\n                            audioRef.current.currentTime = 0;  \n                    }\n                    // if (rightEye + 50 > faceOvalRight || leftEye - 50 < faceOvalLeft) {\n                    //     console.log(false);\n                    // } else {\n                    //     console.log(true);\n                    // }\n                    \n                    //console.log(rightEye);\n                    // Additional logic to handle the detected faces\n                }\n            }, 3000); // Run detection every 1000 milliseconds (1 second)\n        }\n\n        return () => {\n            if (detectionInterval.current) {\n                clearInterval(detectionInterval.current);\n            }\n            audioRef.current.pause();\n        };\n    }, [detector, videoRef]);\n\n    return null;\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}